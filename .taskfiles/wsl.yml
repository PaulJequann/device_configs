version: '3'

tasks:
  check-wsl:
    desc: Verify running in WSL2
    internal: true
    cmds:
      - |
        if ! grep -qi microsoft /proc/version 2>/dev/null; then
          echo "Error: This doesn't appear to be a WSL2 environment"
          exit 1
        fi
        echo "âœ“ Detected WSL2 environment"

  setup:
    desc: WSL2 system setup
    cmds:
      - task: check-wsl
      - task: summary

  summary:
    desc: Display setup summary
    silent: true
    cmds:
      - |
        echo ""
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo "âœ“ WSL2 Setup Complete!"
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo ""
        echo "ğŸ“‹ Next Steps:"
        echo ""
        echo "1. ğŸ³ Docker Desktop"
        echo "   Install Docker Desktop on Windows host and enable WSL2 integration"
        echo "   Download: https://www.docker.com/products/docker-desktop"
        echo ""
        echo "2. ğŸªŸ Windows GUI Applications"
        echo "   Run this command in PowerShell (on Windows host):"
        echo ""
        WINGET_JSON="configs/winget-packages.json"
        WINDOWS_PATH=$(wslpath -w "$(pwd)/$WINGET_JSON" 2>/dev/null || echo "")
        if [ -n "$WINDOWS_PATH" ]; then
          echo "   winget import -i '$WINDOWS_PATH' --accept-package-agreements --accept-source-agreements"
        else
          echo "   (Navigate to your device_configs folder and use winget-packages.json)"
        fi
        echo ""
        echo "   Includes: Windows Terminal, VS Code, Chrome, Edge, Discord, Docker Desktop,"
        echo "   Claude Code, Antigravity, Cursor, Zed, Ollama, Bruno, Alacritty, Steam,"
        echo "   GeForce Now, Moonlight"
        echo ""
        echo "3. ğŸ” SSH Key"
        echo "   Generate your SSH key: task ssh"
        echo ""
        echo "4. ğŸ“ Dotfiles"
        echo "   Setup dotfiles: task dotfiles"
        echo ""
        echo "5. ğŸš Shell"
        echo "   Log out and back in if you changed your default shell to zsh"
        echo ""
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"

  update:
    desc: Update all packages via Homebrew
    cmds:
      - |
        echo "Updating Homebrew packages..."
        brew update && brew upgrade && brew cleanup

  clean:
    desc: Clean Homebrew cache
    cmds:
      - |
        echo "Cleaning Homebrew cache..."
        brew cleanup -s
        rm -rf $(brew --cache)
